#!/bin/bash

# Usage:
# watchdo <folders> -- <command>

watch="fswatch -0 -e \"~$\" -r"
xargs="xargs -0 -I {}";

folders=true
for var in "$@";
do
    if [ "${var}" == "--" ]
    then
        folders=false
    elif [ $folders = true ]
    then
        watch="${watch} ${var}"
    else
        cmd="${cmd} ${var}"
    fi
done

eval "${watch} | ${xargs} ${cmd}"
